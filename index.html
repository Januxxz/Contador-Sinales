<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Contador de Sinais</title>
<script src="https://www.gstatic.com/firebasejs/9.17.2/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.17.2/firebase-database.js"></script>
<style>
    body {
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        font-family: Arial, sans-serif;
    }
    .section-toggle {
        font-size: 1.2em;
        font-weight: bold;
        color: #ffffff;
        background-color: #007bff;
        padding: 10px 20px;
        margin: 10px 0;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        transition: background-color 0.3s ease;
    }
    .section-toggle:hover {
        background-color: #0056b3;
    }
    .counter-section {
        margin-bottom: 20px;
        text-align: center;
    }
    .counter {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        margin-top: 5px;
    }
    .counter span {
        min-width: 40px;
        text-align: center;
    }
    button {
        font-size: 1.2em;
        background-color: transparent;
        border: none;
        cursor: pointer;
    }
    #f3-section, #fresnel-section, #f1-section, #f2-section {
        display: none;
        margin-top: 10px;
        padding: 15px;
        border: 1px solid #ddd;
        border-radius: 8px;
        background-color: #f8f9fa;
    }
</style>
</head>
<body>

<h1>Contador de Sinais</h1>

<!-- Botões para expandir ou esconder as seções -->
<button class="section-toggle" onclick="toggleSection('f1-section')">F1</button>
<div id="f1-section"></div>

<button class="section-toggle" onclick="toggleSection('f2-section')">F2</button>
<div id="f2-section"></div>

<button class="section-toggle" onclick="toggleSection('f3-section')">F3</button>
<div id="f3-section"></div>

<button class="section-toggle" onclick="toggleSection('fresnel-section')">Fresnel</button>
<div id="fresnel-section"></div>

<script>
    // Configuração do Firebase
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.17.2/firebase-app.js";
    import { getDatabase, ref, get, set, update } from "https://www.gstatic.com/firebasejs/9.17.2/firebase-database.js";

    const firebaseConfig = {
        apiKey: "SUA_API_KEY",
        authDomain: "SEU_AUTH_DOMAIN",
        projectId: "SEU_PROJECT_ID",
        storageBucket: "SEU_STORAGE_BUCKET",
        messagingSenderId: "SEU_MESSAGING_SENDER_ID",
        appId: "SEU_APP_ID",
        databaseURL: "SEU_DATABASE_URL"
    };

    const app = initializeApp(firebaseConfig);
    const database = getDatabase(app);

    const sections = [
        { name: "F1 Seta 300", colors: ["Verde", "Amarelo", "Vermelho"], sectionType: "F1" },
        { name: "F1 Seta 200", colors: ["Verde", "Amarelo", "Vermelho"], sectionType: "F1" },
        { name: "F1 300", colors: ["Verde", "Amarelo", "Vermelho"], sectionType: "F1" },
        { name: "F1 200", colors: ["Verde", "Amarelo", "Vermelho"], sectionType: "F1" },
        { name: "F1 Pedestre", colors: ["Verde", "Vermelho"], sectionType: "F1" },
        { name: "F1 Ciclista", colors: ["Verde", "Vermelho"], sectionType: "F1" },
        // Outros...
    ];

    const f1Container = document.getElementById('f1-section');
    const f2Container = document.getElementById('f2-section');
    const f3Container = document.getElementById('f3-section');
    const fresnelContainer = document.getElementById('fresnel-section');

    async function loadCounterValue(section, color) {
        const snapshot = await get(ref(database, `${section}/${color}`));
        return snapshot.exists() ? snapshot.val() : 0;
    }

    async function saveCounterValue(section, color, value) {
        await set(ref(database, `${section}/${color}`), value);
    }

    sections.forEach(section => {
        const sectionDiv = document.createElement('div');
        sectionDiv.className = 'counter-section';
        sectionDiv.innerHTML = `<h2>${section.name}</h2>`;

        section.colors.forEach(color => {
            const counterDiv = document.createElement('div');
            counterDiv.className = 'counter';

            counterDiv.innerHTML = `
                <button onclick="decrement('${section.name}', '${color}')">⬅️</button>
                <span>${color}</span>
                <span id="${section.name}-${color}">Loading...</span>
                <button onclick="increment('${section.name}', '${color}')">➡️</button>
            `;
            sectionDiv.appendChild(counterDiv);

            // Carregar valores do Firebase
            loadCounterValue(section.name, color).then(value => {
                const counterSpan = document.getElementById(`${section.name}-${color}`);
                counterSpan.textContent = value;
            });
        });

        if (section.sectionType === "F1") f1Container.appendChild(sectionDiv);
        else if (section.sectionType === "F2") f2Container.appendChild(sectionDiv);
        else if (section.sectionType === "F3") f3Container.appendChild(sectionDiv);
        else fresnelContainer.appendChild(sectionDiv);
    });

    function increment(section, color) {
        const counterSpan = document.getElementById(`${section}-${color}`);
        let currentValue = parseInt(counterSpan.textContent);
        currentValue++;
        counterSpan.textContent = currentValue;
        saveCounterValue(section, color, currentValue);
    }

    function decrement(section, color) {
        const counterSpan = document.getElementById(`${section}-${color}`);
        let currentValue = parseInt(counterSpan.textContent);
        if (currentValue > 0) {
            currentValue--;
            counterSpan.textContent = currentValue;
            saveCounterValue(section, color, currentValue);
        }
    }

    function toggleSection(sectionId) {
        const section = document.getElementById(sectionId);
        section.style.display = section.style.display === 'none' ? 'block' : 'none';
    }
</script>
</body>
</html>
